<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†æ¢ç´¢ Â· Leo's Blog</title><meta name="description" content="è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†æ¢ç´¢ - Tauleos"><meta name="google-site-verification" content="y-sRxe2Toq8nFRU8PiEYywkdUoWdk_UYysZDKbnM7Ck"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://tauleos.github.io/atom.xml" title="Leo's Blog"><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Leo's Blog" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">HOME</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVES</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">TAGS</a></li><li class="nav-list-item"><a href="https://github.com/Tauleos" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">è‡ªåŠ¨åŒ–ç‰ˆæœ¬ç®¡ç†æ¢ç´¢</h1><div class="post-info">2020å¹´10æœˆ15æ—¥</div><div class="post-content"><p>åœ¨æˆ‘ä»¬æ—¥å¸¸Codingè¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šæœ‰å¼€å‘ç±»åº“çš„éœ€æ±‚</p>
<a id="more"></a>
<p>å¼€å‘å®Œæˆå‘å¸ƒä¹‹åï¼Œåç»­ç‰ˆæœ¬ç®¡ç†ï¼Œæ›´æ–°æ—¥å¿—ç­‰é—®é¢˜ä¹Ÿéšä¹‹è€Œæ¥ï¼Œå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜å‘¢ï¼Ÿ</p>
<h1 id="ä¸€ã€æ‰‹æ‰“"><a href="#ä¸€ã€æ‰‹æ‰“" class="headerlink" title="ä¸€ã€æ‰‹æ‰“"></a>ä¸€ã€æ‰‹æ‰“</h1><ul>
<li>æ‰‹åŠ¨æ›´æ”¹ç‰ˆæœ¬å·</li>
<li>æ‰‹åŠ¨å˜æˆæ›´æ–°æ—¥å¿—</li>
<li>æ‰‹åŠ¨å‘å¸ƒåˆ°npmç§æœ</li>
<li>å™¢è€¶ï¼Œå®Œå·¥</li>
</ul>
<div class="tip">
ä½ ç¡®å®šä½ æ˜¯è®¤çœŸçš„ä¹ˆâ“ï¸â“ï¸â“ï¸æ‰‹åŠ¨é»‘äººé—®å·è„¸
éƒ½2020å¹´äº†è¿˜ä¸èƒ½è‡ªåŠ¨åŒ–å—ï¼Ÿ
</div>

<h1 id="äºŒã€è‡ªåŠ¨åŒ–"><a href="#äºŒã€è‡ªåŠ¨åŒ–" class="headerlink" title="äºŒã€è‡ªåŠ¨åŒ–"></a>äºŒã€è‡ªåŠ¨åŒ–</h1><p>å›åˆ°æ­£é¢˜ï¼Œå¦‚æœæœ‰ä¸€ç§å·¥å…·ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•è¾“å…¥å‘½ä»¤è¡Œï¼Œè½»è½»æ•²ä¸€ä¸‹å›è½¦ï¼Œå°±å¯ä»¥è½»æ¾å¸®æˆ‘ä»¬å®Œæˆæ‰‹åŠ¨çš„é‚£äº›å·¥ä½œï¼Œã€‚æˆ‘ä»¬åªéœ€è¦å™¢è€¶ï¼Œå²‚ä¸å¿«å“‰ã€‚</p>
<p>äºæ˜¯ï¼Œåœ¨ä¼Ÿå¤§çš„githubä¸Šæ•æ‰åˆ°äº†ä»¥ä¸‹ä¸‰ç§å·¥å…·</p>
<ul>
<li>standard-version</li>
<li>semantic-release</li>
<li>lerna</li>
</ul>
<hr>
<blockquote>
<p>è®©æˆ‘ä»¬æ¥è¯¦ç»†çš„åˆ†åˆ«äº†è§£ä¸€ä¸‹è¿™ä¸‰ä½é€‰æ‰‹</p>
</blockquote>
<h2 id="1ã€Lerna"><a href="#1ã€Lerna" class="headerlink" title="1ã€Lerna"></a>1ã€Lerna</h2><p>ä¸ç”¨è¯´ã€‚å…ˆæ·˜æ±°å§ğŸ˜‚ï¸ã€‚æ¯•ç«Ÿè¿™å®¶ä¼™æ ¸å¿ƒä»·å€¼æ˜¯å¤šé¡¹ç›®ç®¡ç†ï¼Œè·Ÿæˆ‘ä»¬çš„éœ€æ±‚æ¯«ä¸æ²¾è¾¹</p>
<h2 id="2ã€standard-version"><a href="#2ã€standard-version" class="headerlink" title="2ã€standard-version"></a>2ã€standard-version</h2><p>æ ¹æ®ä»‹ç»ï¼Œå®ƒçš„æ ¸å¿ƒä»·å€¼è§‚åœ¨äºè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ã€æ‰“tagä»¥åŠCHANGELOGç”Ÿæˆã€‚æ›´ä¸ºåŠ åˆ†çš„æ˜¯å®ƒè¿˜æ˜¯ä»£ç æäº¤è§„èŒƒç»„ç»‡çš„å®˜æ–¹å‡ºå“<br><img src="/images/version-management/standard-version.png" alt="sv"></p>
<blockquote>
<p>A utility for versioning using semver and CHANGELOG generation powered by Conventional Commits. </p>
</blockquote>
<p>å¬ä¸Šå»è›®ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿç®€å•</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">standard-version</span><br></pre></td></tr></table></figure>

<p>åŸºæœ¬ä¸Šå¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„æ—¥å¸¸éœ€æ±‚ã€‚ä½¿ç”¨èµ·æ¥ä¹Ÿæ»¡è¶³æˆ‘ä»¬çš„åˆå§‹ç›®æ ‡ï¼Œä¸€é”®Enterï¼Œæå®šæ‰€æœ‰ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ›´æ”¹æ¨é€åˆ°æœåŠ¡å™¨ï¼Œå¹¶ä¸”å‘å¸ƒå°±å¥½</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git push --follow-tags origin master &amp;&amp; npm publish</span><br></pre></td></tr></table></figure>
<h2 id="3ã€semantic-release"><a href="#3ã€semantic-release" class="headerlink" title="3ã€semantic-release"></a>3ã€semantic-release</h2><p>æ‰“å¼€æ–‡æ¡£ä»‹ç»ï¼ŒåŸæ¥è¿™è´§çš„æ ¸å¿ƒé©±åŠ¨åŠ›åœ¨äºworkflowã€‚</p>
<blockquote>
<p>semantic-release automates the whole package release workflow including: determining the next version number, generating the release notes and publishing the package.</p>
</blockquote>
<p>ç›¸æ¯”æ¥¼ä¸Šé‚£ä½ï¼Œè¯¥é€‰æ‰‹ç»™æˆ‘ä»¬æä¾›äº†ä¸€æ•´å¥—å®Œå¤‡çš„å·¥ä½œæµï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥:</p>
<ul>
<li>å…¨è‡ªåŠ¨release</li>
<li>å¼ºåˆ¶è¯­ä¹‰åŒ–è¯´æ˜</li>
<li>æ’ä»¶åŒ–é…ç½®</li>
<li>ä¸CI/CDé»˜è®¤é›†æˆ<br>å‰©ä¸‹çš„è¿˜æœ‰å¥½å¤šã€‚ã€‚ã€‚å¤§å®¶å¯ä»¥å»å®˜ç½‘çœ‹ã€‚ã€‚ã€‚</li>
</ul>
<p>ä½¿ç”¨æ–¹æ³•<br>Aã€ä½¿ç”¨çš„è¯ä¼šç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œç±»ä¼¼babelï¼Œéœ€è¦åœ¨é¡¹ç›®ä¸­å¢åŠ ä¸€ä¸ª <strong>.releaserc</strong> æ–‡ä»¶è¿›è¡Œæ’ä»¶é…ç½®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;branches&quot;</span>: <span class="string">&quot;master&quot;</span>,</span><br><span class="line">  <span class="comment">// &quot;debug&quot;: true,</span></span><br><span class="line">  <span class="comment">// &quot;dryRun&quot;: true, // semantic-releaseé»˜è®¤åœ¨ciä¸­å·¥ä½œï¼Œå¦‚æœéœ€è¦è°ƒè¯•å¯ä»¥æ‰“å¼€è¿™ä¸ªå¼€å…³</span></span><br><span class="line">  <span class="string">&quot;plugins&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;@semantic-release/commit-analyzer&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@semantic-release/release-notes-generator&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@semantic-release/changelog&quot;</span>,</span><br><span class="line">    [</span><br><span class="line">      <span class="string">&quot;@semantic-release/npm&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;npmPublish&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">&quot;tarballDir&quot;</span>: <span class="string">&quot;dist&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">      <span class="string">&quot;@semantic-release/git&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;assets&quot;</span>: [<span class="string">&quot;package.json&quot;</span>, <span class="string">&quot;CHANGELOG.md&quot;</span>],</span><br><span class="line">        <span class="string">&quot;message&quot;</span>: <span class="string">&quot;chore(è›‹ç³•):$&#123;nextRelease.version&#125; [skip ci]\n\n$&#123;nextRelease.notes&#125;&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">      <span class="string">&quot;@semantic-release/gitlab&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;gitlabUrl&quot;</span>: <span class="string">&quot;https://git.com/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;assets&quot;</span>: <span class="string">&quot;dist/*.tgz&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;preset&quot;</span>: <span class="string">&quot;angular&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Bã€åŒæ—¶éœ€è¦åœ¨ciä¸­å¢åŠ é…ç½®ï¼Œåœ¨é¡¹ç›®ä¸­é…ç½®CIæ‰€éœ€è¦çš„ç¯å¢ƒå˜é‡,åŒ…æ‹¬<code>GL_TOKEN</code>ã€<code>NPM_USERNAME</code>ã€<code>NPM_EMAIL</code>ã€<code>NPM_PASSWORD</code>ç­‰</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">stages:</span></span><br><span class="line">  <span class="comment"># - test</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">release</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">before_script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">publish:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">node:10</span></span><br><span class="line">  <span class="attr">stage:</span> <span class="string">release</span></span><br><span class="line">  <span class="attr">script:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&#x27;//registry.npm.org/:username=$&#123;NPM_USERNAME&#125;&#x27;</span><span class="string">&gt;&gt;.npmrc</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&#x27;//registry.npm.org/:email=$&#123;NPM_EMAIL&#125;&#x27;</span><span class="string">&gt;&gt;.npmrc</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">echo</span> <span class="string">&#x27;//registry.npm.org/:_password=$&#123;NPM_PASSWORD&#125;&#x27;</span><span class="string">&gt;&gt;.npmrc</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">npx</span> <span class="string">semantic-release</span></span><br></pre></td></tr></table></figure>
<p>Cã€æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œéœ€è¦åœ¨gitlabä¸­å¼€å¯<code>PersonalAccessToken</code>ï¼ˆ<del>å‰ææ˜¯å¼€å¯2FAé…ç½®ï¼Œç…§ç€æ­¥éª¤èµ°ï¼ŒæŒºéº»çƒ¦çš„ä¹Ÿèƒ½èµ°é€š</del>åæ¥å‘ç°ä¸ç”¨å¼€å¯2FAä¹Ÿèƒ½èµ°é€šï¼Œé‚£å¯å¤ªæ£’äº†ï¼‰ï¼Œå¹¶è®¾ç½®åœ¨CI/CDçš„å˜é‡ä¸­<br><img src="/images/version-management/pas.png" alt="pat"></p>
<p>Dã€ä¸Šè¿°æ­¥éª¤åšå¥½ï¼Œä¾¿å¯ä»¥æŠŠæ‰€æœ‰æ”¹åŠ¨æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œåç­‰å®ƒå¸¦ç»™ä½ çš„æƒŠå–œ</p>
<div class="tip">å“ˆå“ˆï¼Œå…¶å®é™¤äº†è·Ÿæ¥¼ä¸Šä¸€æ ·çš„æ•ˆæœä¹‹å¤–ï¼Œè¿˜é¢å¤–ç”Ÿæˆäº†gitLabä¸­çš„Releaseã€‚å½“ç„¶å¦‚æœä¸éœ€è¦çš„è¯ä¹Ÿå¯ä»¥å¹²æ‰å®ƒï¼Œä¸è¿‡è¿™ä¹ˆä¸“ä¸šçš„æ“ä½œï¼Œä¸ºå•¥ä¸ä¿ç•™å‘¢ï¼Œå¯¹ä¸å¯¹~ğŸ˜„ï¸</div>

<h2 id="4ã€standard-version-VS-semantiv-release"><a href="#4ã€standard-version-VS-semantiv-release" class="headerlink" title="4ã€standard-version VS semantiv-release"></a>4ã€standard-version VS semantiv-release</h2><table>
<thead>
<tr>
<th align="center">åŠŸèƒ½ç‚¹</th>
<th align="center">standard-version</th>
<th align="center">semantic-release</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ç‰ˆæœ¬æ§åˆ¶</td>
<td align="center">âœ…</td>
<td align="center">âœ…</td>
<td align="center">ä¼šæ ¹æ®æäº¤çš„ä¿¡æ¯ç±»å‹æ¥è‡ªåŠ¨æ›´æ”¹å¯¹åº”çš„ç‰ˆæœ¬å·,å¦‚ä¸‹:<br> feat: æ¬¡ç‰ˆæœ¬(minor)+1 <br>  fix: ä¿®è®¢å·(patch) +1 <br> BREAK CHANGE: ä¸»æ¿å·(marjor) +1</td>
</tr>
<tr>
<td align="center">CHANGELOG</td>
<td align="center">âœ…</td>
<td align="center">âœ…</td>
<td align="center">å‡åŸºäºAngular Commit è§„åˆ™</td>
</tr>
<tr>
<td align="center">gitTagæ ‡è®°</td>
<td align="center">âœ…</td>
<td align="center">âœ…</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">npmè‡ªåŠ¨å‘å¸ƒ</td>
<td align="center"></td>
<td align="center">âœ…</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">CIé›†æˆ</td>
<td align="center">âš ï¸ï¸</td>
<td align="center">âœ…</td>
<td align="center">standard-version å¯ä»¥æ‰‹åŠ¨å®ç°</td>
</tr>
<tr>
<td align="center">pre-releaseå®ç°</td>
<td align="center">âœ…</td>
<td align="center">âœ…</td>
<td align="center">standard-versionï¼šé€šè¿‡å¯é€‰å‚æ•°<br>semantic-release:é€šè¿‡åˆ†æ”¯è®¾ç½®</td>
</tr>
<tr>
<td align="center">gitlab release</td>
<td align="center"></td>
<td align="center">âœ…</td>
<td align="center"></td>
</tr>
</tbody></table>
<h1 id="ä¸‰ã€ç»“è®º"><a href="#ä¸‰ã€ç»“è®º" class="headerlink" title="ä¸‰ã€ç»“è®º"></a>ä¸‰ã€ç»“è®º</h1><p>standard-versionä¸semantic-release éƒ½æ˜¯ä»¤äººæƒŠå¹çš„å·¥å…·ï¼Œä¸ç®¡ä½¿ç”¨å“ªä¸€ä¸ªéƒ½èƒ½å¤Ÿæœ€å¤§é™åº¦çš„æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚å½“ç„¶ä¸¤ä¸ªå·¥å…·çš„ä¾§é‡ç‚¹æ˜¯ä¸ä¸€æ ·çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½æ¥é€‰æ‹©ã€‚<br>åœ¨æˆ‘ä¸ªäººçœ‹æ¥ï¼š</p>
<div class="tip">
standard-version åå‘äºå°å·¥å…·å¼€å‘ï¼Œè‡ªè¡Œå†³å®šç±»åº“çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å‘å¸ƒå‰è¿›è¡Œä¿®æ”¹
semantic-release åå‘äºworkflowï¼Œå¤šäººåä½œä¸‹é€šè¿‡mrè¿›è¡Œéœ€æ±‚çš„è¿­ä»£
</div>
å½“ç„¶ï¼Œæ— è®ºé‡‡å–å“ªç§å§¿åŠ¿ï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒç›®æ ‡åªæœ‰ä¸€ä¸ªï¼š

<p><img src="/images/version-management/dkam.png" alt="killAllHumans"><br>å®Œ~</p>
</div></article></div></main><footer><div class="paginator"><a href="/6aef7f739395.html" class="prev">ä¸Šä¸€ç¯‡</a><a href="/fa64e05e0810.html" class="next">ä¸‹ä¸€ç¯‡</a></div><div id="gitalk-container"></div><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" async></script><script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js" async></script><script>var ds = document.createElement('link');
ds.rel = 'stylesheet';ds.async = true;
ds.href = 'https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
window.onload = function() {
  var gitalk = new Gitalk({
    clientID: '62e01f3aa3f140c5af8a',
    clientSecret: '8f02698609ba488706c5e67839f0bbf46861554f',
    repo: 'Tauleos.github.io',
    owner: 'Tauleos',
    admin: ['Tauleos'],
    id: md5(window.location.pathname),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })
  gitalk.render('gitalk-container');
}</script><div class="copyright"><p id="host_by"><span id="busuanzi_container_site_pv">&nbsp;æœ¬ç«™æ€»è®¿é—®é‡ &nbsp;<span id="busuanzi_value_site_pv"><i class="fa fa-spinner"></i></span> æ¬¡,</span><span id="busanzi_container_site_uv">&nbsp;æœ¬ç«™æ€»è®¿é—®äººæ•° &nbsp;<span id="busuanzi_value_site_uv"><i class="fa fa-spinner"></i></span> æ¬¡.</span></p><p>Â© 2017 - 2021 created by <a href="https://tauleos.github.io">Tauleos</a>,Looking for better life and peace.</p><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script></div></footer></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body></html>